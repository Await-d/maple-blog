# Maple Blog Admin Dashboard Production Environment Configuration
# 管理后台生产环境专用配置文件

# ===========================================
# 域名和网络配置
# ===========================================

# 主域名
DOMAIN_NAME=yourdomain.com

# 管理后台子域名
ADMIN_SUBDOMAIN=admin
ADMIN_API_SUBDOMAIN=admin-api

# 端口配置
ADMIN_HTTP_PORT=8080
ADMIN_HTTPS_PORT=8443

# 完整URL
ADMIN_URL=https://admin.${DOMAIN_NAME}
ADMIN_API_URL=https://admin-api.${DOMAIN_NAME}

# ===========================================
# 数据库配置 (管理后台专用)
# ===========================================

# 数据库提供程序
DATABASE_PROVIDER=PostgreSQL

# PostgreSQL连接配置
POSTGRES_HOST=postgres-service
POSTGRES_PORT=5432
POSTGRES_DB=maple_blog_admin
POSTGRES_USER=admin_user
POSTGRES_PASSWORD=your-super-secure-admin-postgres-password
POSTGRES_CONNECTION_STRING=Host=${POSTGRES_HOST};Port=${POSTGRES_PORT};Database=${POSTGRES_DB};Username=${POSTGRES_USER};Password=${POSTGRES_PASSWORD};SSL Mode=Require;Trust Server Certificate=true

# 连接池配置
POSTGRES_MAX_POOL_SIZE=50
POSTGRES_MIN_POOL_SIZE=5
POSTGRES_CONNECTION_TIMEOUT=30
POSTGRES_COMMAND_TIMEOUT=60

# ===========================================
# Redis缓存配置 (管理后台专用)
# ===========================================

# Redis连接配置
REDIS_HOST=admin-redis-service
REDIS_PORT=6379
REDIS_DATABASE=0
REDIS_PASSWORD=your-super-secure-admin-redis-password
REDIS_CONNECTION_STRING=${REDIS_HOST}:${REDIS_PORT}

# Redis性能配置
REDIS_MAX_CONNECTIONS=20
REDIS_CONNECT_TIMEOUT=5000
REDIS_SYNC_TIMEOUT=5000
REDIS_KEY_PREFIX=admin:

# 缓存策略配置
CACHE_DEFAULT_EXPIRATION_MINUTES=10
CACHE_SLIDING_EXPIRATION_MINUTES=5
CACHE_ABSOLUTE_EXPIRATION_HOURS=2
CACHE_SIZE_LIMIT_MB=256

# ===========================================
# JWT认证配置 (管理后台专用)
# ===========================================

# JWT密钥 (必须至少256位)
JWT_SECRET_KEY=your-super-secure-jwt-secret-key-with-at-least-256-bits-for-production-admin-dashboard-security
JWT_ISSUER=MapleBlog.Admin.Production
JWT_AUDIENCE=MapleBlog.Admin.Production.Users

# JWT过期时间配置
JWT_EXPIRATION_MINUTES=60
JWT_REFRESH_EXPIRATION_DAYS=7
JWT_CLOCK_SKEW_MINUTES=5

# JWT安全配置
JWT_REQUIRE_HTTPS=true
JWT_REQUIRE_AUDIENCE=true
JWT_REQUIRE_ISSUER=true
JWT_VALIDATE_LIFETIME=true
JWT_VALIDATE_SIGNATURE=true

# ===========================================
# 安全配置
# ===========================================

# 管理后台安全设置
ADMIN_REQUIRE_HTTPS=true
ADMIN_REQUIRE_2FA=true
ADMIN_SESSION_TIMEOUT=30
ADMIN_MAX_LOGIN_ATTEMPTS=5
ADMIN_LOCKOUT_DURATION=15
ADMIN_PASSWORD_COMPLEXITY=high

# 密码策略
PASSWORD_MIN_LENGTH=12
PASSWORD_MAX_LENGTH=128
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_DIGITS=true
PASSWORD_REQUIRE_SPECIAL_CHARS=true
PASSWORD_HISTORY_COUNT=5
PASSWORD_EXPIRATION_DAYS=90

# 账户安全
MAX_FAILED_ACCESS_ATTEMPTS=3
DEFAULT_LOCKOUT_TIMESPAN=00:15:00
REQUIRE_CONFIRMED_EMAIL=true
REQUIRE_UNIQUE_EMAIL=true

# IP限制 (可选，逗号分隔)
ALLOWED_IP_RANGES=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
BLOCKED_IP_RANGES=

# ===========================================
# 限流配置
# ===========================================

# API限流
RATE_LIMIT_ENABLED=true
RATE_LIMIT_RPM=100
RATE_LIMIT_BURST=20
RATE_LIMIT_WINDOW_MINUTES=1

# 登录限流
RATE_LIMIT_LOGIN_RPM=5
RATE_LIMIT_LOGIN_BURST=3
RATE_LIMIT_LOGIN_WINDOW_MINUTES=1

# 上传限流
RATE_LIMIT_UPLOAD_RPM=10
RATE_LIMIT_UPLOAD_BURST=5

# ===========================================
# 文件上传配置
# ===========================================

# 上传限制
MAX_UPLOAD_SIZE=100MB
MAX_TOTAL_UPLOAD_SIZE=500MB
ALLOWED_UPLOAD_TYPES=jpg,jpeg,png,gif,webp,svg,pdf,doc,docx,xls,xlsx,ppt,pptx,zip
UPLOAD_PATH=/app/uploads
UPLOAD_TEMP_PATH=/app/temp

# 文件安全
SCAN_UPLOADED_FILES=true
QUARANTINE_SUSPICIOUS_FILES=true
VIRUS_SCAN_ENABLED=true

# ===========================================
# 监控和日志配置
# ===========================================

# 监控配置
MONITORING_ENABLED=true
METRICS_ENABLED=true
METRICS_PATH=/metrics
HEALTH_CHECK_PATH=/health
PERFORMANCE_MONITORING=true
ERROR_TRACKING=true

# 日志配置
LOG_LEVEL=Information
LOG_TO_FILE=true
LOG_TO_CONSOLE=true
LOG_STRUCTURED=true
LOG_INCLUDE_SCOPES=true

# 日志文件配置
LOG_FILE_PATH=/app/logs/admin-.log
LOG_FILE_SIZE_LIMIT_MB=50
LOG_FILE_COUNT_LIMIT=10
LOG_RETENTION_DAYS=30

# 审计日志
AUDIT_LOG_ENABLED=true
AUDIT_LOG_ALL_REQUESTS=true
AUDIT_LOG_SENSITIVE_DATA=false
AUDIT_LOG_PATH=/app/logs/audit-.log

# ===========================================
# 性能配置
# ===========================================

# 应用性能
ENABLE_RESPONSE_CACHING=true
ENABLE_COMPRESSION=true
ENABLE_HTTP2=true
ENABLE_HTTPS_REDIRECT=true

# 数据库性能
ENABLE_QUERY_CACHE=true
QUERY_CACHE_SIZE_MB=128
ENABLE_CONNECTION_POOLING=true

# 内存配置
MAX_REQUEST_SIZE=100MB
REQUEST_TIMEOUT_SECONDS=60
MAX_CONCURRENT_REQUESTS=100

# ===========================================
# 第三方服务配置
# ===========================================

# 邮件服务
SMTP_HOST=smtp.yourdomain.com
SMTP_PORT=587
SMTP_USER=admin@yourdomain.com
SMTP_PASSWORD=your-smtp-password
SMTP_FROM_NAME=Maple Blog Admin
SMTP_FROM_EMAIL=admin@yourdomain.com
SMTP_USE_TLS=true
SMTP_USE_SSL=false

# 两步验证
TOTP_ISSUER=Maple Blog Admin
TOTP_WINDOW=30
TOTP_BACKUP_CODES_COUNT=10

# 验证码服务
RECAPTCHA_ENABLED=true
RECAPTCHA_SITE_KEY=your-recaptcha-site-key
RECAPTCHA_SECRET_KEY=your-recaptcha-secret-key
RECAPTCHA_SCORE_THRESHOLD=0.5

# ===========================================
# 环境和部署配置
# ===========================================

# 应用环境
ASPNETCORE_ENVIRONMENT=Production
REACT_APP_ENVIRONMENT=production
NODE_ENV=production

# 版本信息
APP_VERSION=1.0.0
APP_BUILD_NUMBER=${BUILD_NUMBER:-1}
APP_BUILD_DATE=${BUILD_DATE}
APP_COMMIT_HASH=${COMMIT_HASH}

# 调试配置 (生产环境应为false)
DEBUG_MODE=false
DETAILED_ERRORS=false
DEVELOPER_EXCEPTION_PAGE=false
SWAGGER_ENABLED=false

# ===========================================
# SSL/TLS配置
# ===========================================

# SSL证书路径
SSL_CERT_PATH=/etc/nginx/ssl/admin.${DOMAIN_NAME}.crt
SSL_KEY_PATH=/etc/nginx/ssl/admin.${DOMAIN_NAME}.key
SSL_CA_PATH=/etc/nginx/ssl/ca.crt

# SSL配置
SSL_PROTOCOLS=TLSv1.2 TLSv1.3
SSL_CIPHERS=ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305
SSL_PREFER_SERVER_CIPHERS=on
SSL_HSTS_MAX_AGE=31536000
SSL_HSTS_INCLUDE_SUBDOMAINS=true
SSL_HSTS_PRELOAD=true

# ===========================================
# 容器和资源配置
# ===========================================

# 容器配置
CONTAINER_TIMEZONE=Asia/Shanghai
CONTAINER_USER_ID=1000
CONTAINER_GROUP_ID=1000

# 资源限制
MEMORY_LIMIT=2Gi
CPU_LIMIT=1000m
MEMORY_REQUEST=1Gi
CPU_REQUEST=500m

# 数据路径配置
ADMIN_DATA_PATH=/data/admin
ADMIN_LOGS_PATH=/data/admin/logs
ADMIN_UPLOADS_PATH=/data/admin/uploads
ADMIN_STATIC_PATH=/data/admin/static
ADMIN_REDIS_DATA_PATH=/data/admin/redis
ADMIN_BACKUP_PATH=/backup/admin

# ===========================================
# Docker和Kubernetes配置
# ===========================================

# Docker配置
DOCKER_REGISTRY=your-registry.com
DOCKER_NAMESPACE=maple-blog
DOCKER_TAG=latest
DOCKER_IMAGE_BACKEND=${DOCKER_REGISTRY}/${DOCKER_NAMESPACE}/admin-backend:${DOCKER_TAG}
DOCKER_IMAGE_FRONTEND=${DOCKER_REGISTRY}/${DOCKER_NAMESPACE}/admin-frontend:${DOCKER_TAG}

# Kubernetes配置
K8S_NAMESPACE=maple-blog-admin
K8S_STORAGE_CLASS=fast-ssd
K8S_INGRESS_CLASS=nginx
K8S_CERT_MANAGER_ISSUER=letsencrypt-prod

# ===========================================
# 功能开关
# ===========================================

# 功能标志
FEATURE_USER_MANAGEMENT=true
FEATURE_CONTENT_MANAGEMENT=true
FEATURE_ANALYTICS=true
FEATURE_SYSTEM_MONITORING=true
FEATURE_SECURITY_SCANNING=true
FEATURE_BACKUP_RESTORE=true
FEATURE_BULK_OPERATIONS=true
FEATURE_ADVANCED_SEARCH=true
FEATURE_EXPORT_IMPORT=true
FEATURE_THEME_CUSTOMIZATION=true

# 安全功能
FEATURE_TWO_FACTOR_AUTH=true
FEATURE_AUDIT_LOGGING=true
FEATURE_IP_WHITELIST=true
FEATURE_RATE_LIMITING=true
FEATURE_CAPTCHA=true
FEATURE_SESSION_MANAGEMENT=true

# ===========================================
# 合规和备份配置
# ===========================================

# 合规配置
COMPLIANCE_MODE=strict
DATA_RETENTION_POLICY=gdpr
PRIVACY_MODE=enhanced
GDPR_ENABLED=true
CCPA_ENABLED=true

# 备份配置
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_ENCRYPTION=true
BACKUP_COMPRESSION=true

# ===========================================
# 外部集成配置
# ===========================================

# 分析和监控
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
GOOGLE_ANALYTICS_ID=GA-XXXXXXXXX
PROMETHEUS_ENABLED=true
GRAFANA_ENABLED=true

# 通知服务
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/your/webhook/url
TEAMS_WEBHOOK_URL=https://your-teams-webhook-url
EMAIL_NOTIFICATIONS=true
PUSH_NOTIFICATIONS=false

# CDN配置 (可选)
CDN_ENABLED=false
CDN_URL=https://cdn.yourdomain.com
CDN_STATIC_PATH=/admin/static
CDN_CACHE_TTL=86400

# ===========================================
# 开发和测试配置 (生产环境应禁用)
# ===========================================

# 开发配置 (生产环境禁用)
ENABLE_CORS=false
ENABLE_SWAGGER=false
ENABLE_PROFILING=false
ENABLE_SEEDING=false
ENABLE_DEMO_DATA=false